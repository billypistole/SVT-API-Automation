<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="daa4282d-2a24-4121-a3ef-7eeea983e249" created="2.2.0" activeEnvironment="Default environment" name="TestCompleteResultsProcessor" resourceRoot="" updated="2.2.0 2017-11-28T12:17:25Z" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="70cdd7de-1655-4d15-b0c3-bab58dd03505" wadlVersion="http://wadl.dev.java.net/2009/02" name="" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://watchguardvideo.yourzephyr.com</con:endpoint></con:endpoints><con:resource name="TestCompleteResultsProcessor" path="/flex/services/rest/latest/execution/bulk" id="a84d5a89-3cc3-47eb-a880-68e418552073"><con:settings/><con:parameters><con:parameter><con:name>scheduleids</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>status</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>testerid</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="TestCompleteResultsProcessor" id="9541f9d6-2c75-43f1-bd74-71d506cbbb7b" method="PUT"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>405</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>401 403 500</con:status><con:params/><con:element xmlns:bulk="https://watchguardvideo.yourzephyr.com/flex/services/rest/latest/execution/bulk">bulk:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="d2136765-83bf-4dfc-bdca-9ea5b4caf3d7" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://watchguardvideo.yourzephyr.com</con:endpoint><con:request/><con:originalUri>https://watchguardvideo.yourzephyr.com/flex/services/rest/latest/execution/bulk</con:originalUri><con:credentials><con:selectedAuthProfile>Zephyr</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:parameterOrder><con:entry>scheduleids</con:entry><con:entry>status</con:entry><con:entry>testerid</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="bcafcc3e-c6c9-4c1c-a4b3-1ce05b0206b9" name="TestSuite"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="4a3a722d-feb5-4491-b9fe-dfdf7ab3c81d" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TestCase" searchProperties="true" timeout="0"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="datasource" name="jsonfile" id="247a682d-e61b-4a51-823b-d4bac5ecf234"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Directory"><con:configuration><directory>C:/Users/billypistole/Downloads</directory><filter>TestComplete_Zephyr.json</filter><encoding/></con:configuration></con:dataSource><con:shared>true</con:shared><con:restartShared>true</con:restartShared><con:property>data</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="7b5cdf6b-91d1-480b-9b49-06b09ccf6003"><con:settings/><con:config><script>log.info("  --------------------------------------------------------------------------------------------------------------------------------------------------------")
log.info("  TestComplete UI Automation results processor")
log.info("  --------------------------------------------------------------------------------------------------------------------------------------------------------")

import groovy.json.JsonSlurper
def response = context.expand( '${jsonfile#data#$[\'testcomplete\']}' )
def jsonSlurper = new JsonSlurper()
def object = jsonSlurper.parseText(response)
log.info(object)
def ResultsCount = object.size()
log.info("  Results Count = " + ResultsCount)

def int i = 0
while(i &lt; ResultsCount)
{
	log.info("   Result Number: " + i)
	def ScheduleID = object[i].ZEPHYRSCID
	log.info("   Schedule ID: " + ScheduleID)
	testRunner.testCase.setPropertyValue( "ScheduleID_Prop", ScheduleID)

	def TesterID = object[i].TESTER
	log.info("   Tester ID: " + TesterID)
	testRunner.testCase.setPropertyValue( "TesterID_Prop", TesterID)
	
	def ResultID = object[i].RESULT
	log.info("   Result ID: " + ResultID)
	testRunner.testCase.setPropertyValue( "ResultID_Prop", ResultID)

	testRunner.runTestStepByName("Send Result")
	
	sleep(500)
	i++
}

testRunner.cancel("  " + (i+1) + " Results processed")
</script></con:config></con:testStep><con:testStep type="restrequest" name="Send Result" id="5651c477-7edb-421f-bfa4-b4efa87f2a74"><con:settings/><con:config service="" resourcePath="/flex/services/rest/latest/execution/bulk" methodName="TestCompleteResultsProcessor" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Send Result" id="d2136765-83bf-4dfc-bdca-9ea5b4caf3d7" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://watchguardvideo.yourzephyr.com</con:endpoint><con:request/><con:originalUri>https://watchguardvideo.yourzephyr.com/flex/services/rest/latest/execution/bulk</con:originalUri><con:assertion type="Simple Contains" id="2334f2f6-11ee-4518-96ec-1cd34f82abb4" name="Contains"><con:configuration><token>id</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="63687cd0-4f8e-43dd-8ff0-8be43bca55fe" name="Valid HTTP Status Codes"><con:settings/><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>Zephyr</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters>
  <con:entry key="testerid" value="${#TestCase#TesterID_Prop}"/>
  <con:entry key="scheduleids" value="${#TestCase#ScheduleID_Prop}"/>
  <con:entry key="status" value="${#TestCase#ResultID_Prop}"/>
</con:parameters><con:parameterOrder><con:entry>scheduleids</con:entry><con:entry>status</con:entry><con:entry>testerid</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>ScheduleID_Prop</con:name><con:value>19210</con:value></con:property><con:property><con:name>ResultID_Prop</con:name><con:value>2</con:value></con:property><con:property><con:name>TesterID_Prop</con:name><con:value>7</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>247a682d-e61b-4a51-823b-d4bac5ecf234</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase><con:properties/><con:reportParameters/></con:testSuite><con:savedRecentRuns>1</con:savedRecentRuns><con:requirements/><con:properties/><con:wssContainer/><con:databaseConnectionContainer/><con:jmsConnectionContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:reporting><con:reportTemplates/><con:xmlTemplates/><con:xmlTemplates/><con:parameters/><con:parameters/></con:reporting><con:reporting/><con:authRepository><con:basicAuthEntry><con:name>Zephyr</con:name><con:type>Basic</con:type><con:username>billy.pistole</con:username><con:password>billy.pistole</con:password><con:preemptive>true</con:preemptive></con:basicAuthEntry></con:authRepository><con:tags/></con:soapui-project>